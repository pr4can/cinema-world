(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(n){let s,i,c,l=document.querySelector(".products"),o=document.querySelector(".single-page"),d=document.querySelectorAll(".nav__item"),{genre:g,year:_,country:m}=localStorage,p=document.querySelector(".header__burger"),u=document.querySelector(".header__nav");const f=fetch("https://pr4can.github.io/cinema-world/files/cinema.json").then((e=>e.json()));document.addEventListener("click",(function(t){if(c=document.querySelectorAll(".pagination__item"),t.target.closest(".dropdown__item")){t.preventDefault(),localStorage.setItem(t.target.dataset.filterName,t.target.textContent),d.forEach((e=>e.classList.remove("--open")));let{genre:n,year:r,country:c}=localStorage;i=a(n,r,c,s),e(i,4)}if(t.target.classList.contains("tags__delete")){t.preventDefault(),localStorage.removeItem(t.target.dataset.filterName),t.target.parentElement.remove();let{genre:n,year:r,country:c}=localStorage;i=a(n,r,c,s),e(i,4)}if(t.target.classList.contains("pagination__item")){t.preventDefault();let e=t.target.dataset.page;r(e,4,i),c.forEach((e=>e.classList.remove("--active"))),t.target.classList.add("--active")}t.target.closest(".nav__item span")&&(d.forEach((e=>e.classList.remove("--open"))),t.target.closest(".nav__item").classList.add("--open")),t.target.closest(".nav__item")||d.forEach((e=>e.classList.remove("--open")))}));try{p.addEventListener("click",(function(e){e.preventDefault(),p.classList.contains("--active")?(p.classList.remove("--active"),u.classList.remove("--open")):(p.classList.add("--active"),u.classList.add("--open"))}))}catch(e){}if(1==function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+"is_beta".replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}()){let e=document.querySelector(".footer__develop span");e.innerHTML="&#128516;"+e.textContent}if(l)(async()=>{s=await f,t(s),i=a(g,_,m,s),e(i,4)})();else if(o){const e=window.location.search;(async e=>{s=await f,s=s.filter((t=>t.id==e));let t=s[0],a=`\n            <section class="single-page" style="background-image: url(img/${t.poster});">\n                <div class="single-page__container container">\n                    <h1 class="single-page__title">${t.characteristics.title}</h1>\n                    <div class="single-page__info">\n                        <p class="single-page__year">Год: ${t.characteristics.year}</p>\n                        <p class="single-page__country">Страна: ${t.characteristics.country}</p>\n                        <p class="single-page__desc">${t.characteristics.description}</p>\n                        <a data-fslightbox="video" href="${t.characteristics.trailer}" class="single-page__trailer"><img src="img/${t.poster}" alt=""></a> \n                    </div>         \n                </div>\n            </section>\n        `;document.querySelector("main").innerHTML=a,refreshFsLightbox()})(new URLSearchParams(e).get("id"))}}));const e=(e,t)=>{s(t,e),r(1,t,e),n()},t=e=>{let t=[],a=[],n=[],s=document.querySelector("[data-genres]"),r=document.querySelector("[data-years]"),i=document.querySelector("[data-countries]");e.forEach((e=>{t.push(e.characteristics.genre),a.push(e.characteristics.year),n.push(e.characteristics.country)})),t=t.filter(((e,a)=>t.indexOf(e)===a)),t=t.map((e=>`\n            <li class="dropdown__item"><a href="" data-filter-name="genre">${e}</a></li>\n        `)),s.innerHTML=t.join(""),a=a.filter(((e,t)=>a.indexOf(e)===t)),a=a.map((e=>`\n            <li class="dropdown__item"><a href="" data-filter-name="year">${e}</a></li>\n        `)),r.innerHTML=a.join(""),n=n.filter(((e,t)=>n.indexOf(e)===t)),n=n.map((e=>`\n            <li class="dropdown__item"><a href="" data-filter-name="country">${e}</a></li>\n        `)),i.innerHTML=n.join("")},a=(e,t,a,n)=>(e&&(n=n.filter((t=>t.characteristics.genre==e))),t&&(n=n.filter((e=>e.characteristics.year==t))),a&&(n=n.filter((e=>e.characteristics.country==a))),n),n=()=>{const e=document.querySelector(".tags__row");let{genre:t,year:a,country:n}=localStorage,s="";t&&(s+=`\n            <div class="tags__item">\n                <span class="tags__name">${t}</span>\n                <a href="" class="tags__delete" data-filter-name="genre"></a>\n            </div>\n        `),a&&(s+=`\n            <div class="tags__item">\n                <span class="tags__name">${a}</span>\n                <a href="" class="tags__delete" data-filter-name="year"></a>\n            </div>\n        `),n&&(s+=`\n            <div class="tags__item">\n                <span class="tags__name">${n}</span>\n                <a href="" class="tags__delete" data-filter-name="country"></a>\n            </div>\n        `),e.innerHTML=s},s=(e,t)=>{let a="";const n=document.querySelector(".pagination__row"),s=t.length,r=Math.ceil(s/e);if(r>1)for(let e=1;e<=r;e++)a+=1==e?`<a href="#" class="pagination__item --active" data-page="${e}">${e}</a>`:`<a href="#" class="pagination__item" data-page="${e}">${e}</a>`;n.innerHTML=a},r=(e=1,t=2,a)=>{const n=document.querySelector(".list__row");let s,r;1==e||e<=0?(s=0,r=t):e>a.length?(s=e-1,r=a.length):(s=e*t-t,r=s+t);const i=a.slice(s,r).map((e=>`\n            <div class="list__item item">\n                <img class="item__img" src="img/${e.poster}" alt=""></a>\n                <div class="item__inner">\n                    <p class="item__genre ${e.characteristics.genreClass}">${e.characteristics.genre}</p>\n                    <p class="item__name">${e.characteristics.title}</p>\n                    <p class="item__year">${e.characteristics.year}</p>\n                    <p class="item__country">${e.characteristics.country}</p>\n                    <a href="single-page.html?id=${e.id}" class="item__more">Подробнее</a>\n                </div>                                \n            </div>\n        `));n.innerHTML=i.join("")}})();